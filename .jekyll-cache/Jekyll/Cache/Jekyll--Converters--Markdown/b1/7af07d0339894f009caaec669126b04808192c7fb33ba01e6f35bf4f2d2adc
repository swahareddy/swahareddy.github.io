I"<h1 id="simulation-of-whatsapp-conversations">Simulation of Whatsapp conversations</h1>
<p>Fine tune Open AIâ€™s GPT2 on Whatsapp Chats to generate conversations. Works for both group chats and private chats.</p>

<!-- <a href="https://github.com/swahareddy/gpt2AI_whatsapp_simulation" class="icon brands alt fa-github"><span class="label">GitHub</span> Check out the code on GitHub</a> -->

<p>The following steps are for running a Colab notebook, you can also run it locally. In that case itâ€™d take longer since you donâ€™t get Colabâ€™s GPUs and youâ€™d also have to replace the google drive folders with local ones.</p>

<p>There are 4 versions of the pretrained model. I have used the second largest one (774M, Large, Â¬3GB). Colab (free version) was frequently crashing with the extra-large model.
I wonâ€™t be describing GPT-2 in detail, instead Iâ€™d encourage you to check this out if you are not familiar with it - <a href="https://openai.com/blog/better-language-models/">https://openai.com/blog/better-language-models/</a></p>

<h2 id="how-to-use">How to use:</h2>
<ol>
  <li>Export chats from Whatsapp mobile application. This will give you a file with a name like <code class="language-plaintext highlighter-rouge">WhatsApp Chat with Sushil Khairnar.txt</code></li>
</ol>

<p><img src="gpt2Whatsapp_images/WhatsApp%20Image%202020-08-02%20at%2011.52.43.jpeg" height="240" width="330" /> <img src="gpt2Whatsapp_images/WhatsApp%20Image%202020-08-02%20at%2011.52.43%20(1).jpeg" height="240" width="340" /></p>

<ol>
  <li>
    <p>Create the following hierarchy in your google drive 
<img src="gpt2Whatsapp_images/gdrive_structure.png" height="240" width="330" /></p>
  </li>
  <li>
    <p>Upload the <code class="language-plaintext highlighter-rouge">original_chat.txt</code> in your google drive in the folder <code class="language-plaintext highlighter-rouge">Original Chats</code></p>
  </li>
  <li>
    <p>Run the jupter notebook on Google colab.</p>
  </li>
  <li>
    <p>Check your output (<code class="language-plaintext highlighter-rouge">gpt2_gentext_sushil_khairnar_20200802_084751.txt</code>) in the <code class="language-plaintext highlighter-rouge">Predicted Chats</code> folder</p>
  </li>
</ol>

<blockquote>
  <p><em>I have intentionally cleared outputs of the cells before pushing the notebook to this repository, since both the original and predicted chats should be private. But rest assured, youâ€™ll be seeing some really interesting (and probably disturbing :P) results.</em></p>
</blockquote>

<h2 id="misc">Misc</h2>

<ul>
  <li>
    <p>The training checkpoints can be backed up into <code class="language-plaintext highlighter-rouge">Chat models</code> in case you want to come back and use the fine-tuned model later. This code cell is commented by default since the checkpoint size is &gt;3GB.</p>
  </li>
  <li>
    <p>The copy of files (<code class="language-plaintext highlighter-rouge">generated_text</code>) from Colab local runtime -&gt; GDrive is a little slow, give it a couple of minutes</p>
  </li>
  <li>
    <p>Drop a mail at swahareddy@gmail.com for any comments.</p>
  </li>
</ul>

<lottie-player src="https://assets3.lottiefiles.com/packages/lf20_i0pPw5.json" background="transparent" speed="1" style="width: 300px; height: 300px; text-align:right;" loop="" autoplay=""></lottie-player>

:ET